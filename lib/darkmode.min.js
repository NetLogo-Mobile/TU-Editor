const IS_BROWSER="undefined"!=typeof window;class Darkmode{constructor(e){if(!IS_BROWSER)return;let t={bottom:"32px",right:"32px",left:"unset",time:"0.3s",mixColor:"#fff",backgroundColor:"#fff",buttonColorDark:"#100f2c",buttonColorLight:"#fff",label:"",saveInCookies:!0,autoMatchOsTheme:!0};e=Object.assign({},t,e);let a=`
      .darkmode-layer {
        position: fixed;
        pointer-events: none;
        background: ${e.mixColor};
        transition: all ${e.time} ease;
        mix-blend-mode: difference;
      }

      .darkmode-layer--button {
        width: 2.9rem;
        height: 2.9rem;
        border-radius: 50%;
        right: ${e.right};
        bottom: ${e.bottom};
        left: ${e.left};
      }

      .darkmode-layer--simple {
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        transform: scale(1) !important;
      }

      .darkmode-layer--expanded {
        transform: scale(100);
        border-radius: 0;
      }

      .darkmode-layer--no-transition {
        transition: none;
      }

      .darkmode-toggle {
        background: ${e.buttonColorDark};
        width: 3rem;
        height: 3rem;
        position: fixed;
        border-radius: 50%;
        border:none;
        right: ${e.right};
        bottom: ${e.bottom};
        left: ${e.left};
        cursor: pointer;
        transition: all 0.5s ease;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .darkmode-toggle--white {
        background: ${e.buttonColorLight};
      }

      .darkmode-toggle--inactive {
        display: none;
      }

      .darkmode-background {
        background: ${e.backgroundColor};
        position: fixed;
        pointer-events: none;
        z-index: -10;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
      }

      .darkmode-ignore {
        isolation: isolate;
        display: inline-block;
        z-index: 5000;
      }

      .cp-widget-wrap {
        background-color: white;
      }

      .cp-widget-box {
        mix-blend-mode: difference;
      }

      @media screen and (-ms-high-contrast: active), (-ms-high-contrast: none) {
        .darkmode-toggle {display: none !important}
      }

      @supports (-ms-ime-align:auto), (-ms-accelerator:true) {
        .darkmode-toggle {display: none !important}
      }
    `,d=document.createElement("div"),o=document.createElement("button"),i=document.createElement("div");o.innerHTML=e.label,o.classList.add("darkmode-toggle--inactive"),d.classList.add("darkmode-layer"),i.classList.add("darkmode-background");let r="true"===window.localStorage.getItem("darkmode"),s=e.autoMatchOsTheme&&window.matchMedia("(prefers-color-scheme: dark)").matches,l=null===window.localStorage.getItem("darkmode");(!0===r&&e.saveInCookies||l&&s)&&(d.classList.add("darkmode-layer--expanded","darkmode-layer--simple","darkmode-layer--no-transition"),o.classList.add("darkmode-toggle--white"),document.body.classList.add("darkmode--activated")),document.body.insertBefore(o,document.body.firstChild),document.body.insertBefore(d,document.body.firstChild),document.body.insertBefore(i,document.body.firstChild),this.addStyle(a),this.button=o,this.layer=d,this.saveInCookies=e.saveInCookies,this.time=e.time}updateWidgetBoxStyle(e){let t=document.querySelector("#cp-widget-box-style");t&&(t.textContent=`
            .cp-widget-box {
                mix-blend-mode: ${e?"difference":"normal"}`)}addStyle(e){let t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href","data:text/css;charset=UTF-8,"+encodeURIComponent(e)),document.head.appendChild(t);let a=document.createElement("style");a.setAttribute("id","cp-widget-box-style"),document.head.appendChild(a);let d=this.isActivated();this.updateWidgetBoxStyle(d)}showWidget(){if(!IS_BROWSER)return;let e=this.button,t=this.layer,a=1e3*parseFloat(this.time);e.classList.add("darkmode-toggle"),e.classList.remove("darkmode-toggle--inactive"),e.setAttribute("aria-label","Activate dark mode"),e.setAttribute("aria-checked","false"),e.setAttribute("role","checkbox"),t.classList.add("darkmode-layer--button"),e.addEventListener("click",()=>{let d=this.isActivated();d?(t.classList.remove("darkmode-layer--simple"),e.setAttribute("disabled",!0),setTimeout(()=>{t.classList.remove("darkmode-layer--no-transition"),t.classList.remove("darkmode-layer--expanded"),e.removeAttribute("disabled")},1)):(t.classList.add("darkmode-layer--expanded"),e.setAttribute("disabled",!0),setTimeout(()=>{t.classList.add("darkmode-layer--no-transition"),t.classList.add("darkmode-layer--simple"),e.removeAttribute("disabled")},a)),e.classList.toggle("darkmode-toggle--white"),document.body.classList.toggle("darkmode--activated"),window.localStorage.setItem("darkmode",!d),this.updateWidgetBoxStyle(!d)})}toggle(){if(!IS_BROWSER)return;let e=this.layer,t=this.isActivated(),a=this.button;e.classList.toggle("darkmode-layer--simple"),document.body.classList.toggle("darkmode--activated"),window.localStorage.setItem("darkmode",!t),this.updateWidgetBoxStyle(!t),a.setAttribute("aria-label","De-activate dark mode"),a.setAttribute("aria-checked","true")}isActivated(){return IS_BROWSER?document.body.classList.contains("darkmode--activated"):null}}
